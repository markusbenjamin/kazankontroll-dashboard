(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     31113,        769]
NotebookOptionsPosition[     27758,        707]
NotebookOutlinePosition[     28221,        724]
CellTagsIndexPosition[     28178,        721]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["functions", "Section",
 CellChangeTimes->{{3.9097501410708375`*^9, 3.909750141918227*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DateDifferenceInUnits", "[", 
   RowBox[{"date1_DateObject", ",", "date2_DateObject", ",", "unit_"}], "]"}],
   ":=", 
  RowBox[{"QuantityMagnitude", "[", 
   RowBox[{"DateDifference", "[", 
    RowBox[{"date1", ",", "date2", ",", "unit"}], "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.9084526517756166`*^9, 3.908452651776616*^9}},
 CellLabel->"In[1]:="],

Cell[BoxData[
 RowBox[{
  RowBox[{"PrecedingVal", "[", 
   RowBox[{"list_", ",", "val_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"nearestVal", ",", "nearestPos"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nearestVal", "=", 
      RowBox[{
       RowBox[{"Nearest", "[", 
        RowBox[{"list", ",", "val"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nearestPos", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"list", ",", "nearestVal"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nearestVal", "<", "val"}], ",", "\[IndentingNewLine]", 
       "nearestVal", ",", "\[IndentingNewLine]", 
       RowBox[{"list", "[", 
        RowBox[{"[", 
         RowBox[{"nearestPos", "-", "1"}], "]"}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.909595160403163*^9, 3.909595172046154*^9}, {
  3.9095953444993*^9, 3.90959536152275*^9}},
 CellLabel->"In[5]:="],

Cell[BoxData[
 RowBox[{
  RowBox[{"PrecedingPos", "[", 
   RowBox[{"list_", ",", "val_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"nearestVal", ",", "nearestPos"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nearestVal", "=", 
      RowBox[{
       RowBox[{"Nearest", "[", 
        RowBox[{"list", ",", "val"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nearestPos", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Position", "[", 
         RowBox[{"list", ",", "nearestVal"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nearestVal", "<", "val"}], ",", "\[IndentingNewLine]", 
       "nearestPos", ",", "\[IndentingNewLine]", 
       RowBox[{"nearestPos", "-", "1"}]}], "\[IndentingNewLine]", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.909595552164418*^9, 3.9095955630293283`*^9}},
 CellLabel->"In[3]:="],

Cell[BoxData[
 RowBox[{
  RowBox[{"SparseTimeMovingAverage", "[", 
   RowBox[{"data_List", ",", 
    RowBox[{"windowSize_", "?", "NumericQ"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "times", ",", "values", ",", "averageValues", ",", "result", ",", 
      "halfWindow", ",", "timeWindowIndices"}], "}"}], ",", 
    RowBox[{"(*", 
     RowBox[{"Extract", " ", "times", " ", "and", " ", "values"}], "*)"}], 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"times", ",", "values"}], "}"}], "=", 
      RowBox[{"Transpose", "[", "data", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Half", " ", "of", " ", "the", " ", "window", " ", "size"}], 
      "*)"}], 
     RowBox[{"halfWindow", "=", 
      RowBox[{"windowSize", "/", "2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Moving", " ", "average", " ", "calculation"}], "*)"}], 
     RowBox[{"averageValues", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"(*", 
        RowBox[{
        "Find", " ", "indices", " ", "of", " ", "times", " ", "within", " ", 
         "the", " ", "window", " ", "around", " ", "the", " ", "current", " ",
          "time", " ", "point"}], "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{"timeWindowIndices", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Position", "[", 
            RowBox[{"times", ",", 
             RowBox[{"_", "?", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Abs", "[", 
                  RowBox[{"#", "-", 
                   RowBox[{"times", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}], "<=", 
                 "halfWindow"}], "&"}], ")"}]}]}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "timeWindowIndices", "]"}], ">", "0"}], 
           ",", 
           RowBox[{"Mean", "[", 
            RowBox[{"values", "[", 
             RowBox[{"[", "timeWindowIndices", "]"}], "]"}], "]"}], ",", 
           RowBox[{"(*", 
            RowBox[{
            "Calculate", " ", "mean", " ", "if", " ", "indices", " ", "are", 
             " ", "found"}], "*)"}], 
           RowBox[{"values", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], " ", 
          RowBox[{"(*", 
           RowBox[{
           "Use", " ", "current", " ", "value", " ", "if", " ", "no", " ", 
            "other", " ", "values", " ", "are", " ", "in", " ", "the", " ", 
            "window"}], "*)"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "times", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Combine", " ", "times", " ", "with", " ", "calculated", " ", 
       "averages"}], "*)"}], 
     RowBox[{"result", "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"times", ",", "averageValues"}], "}"}], "]"}]}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.909672239284593*^9, 3.909672252436393*^9}, 
   3.9096725234075937`*^9},
 CellLabel->"In[4]:="]
}, Open  ]],

Cell[CellGroupData[{

Cell["gas", "Section",
 CellChangeTimes->{{3.9097501410708375`*^9, 3.909750146861393*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"voltageTimestamps", "=", 
   RowBox[{"StringSplit", "[", 
    RowBox[{
     RowBox[{"Import", "[", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
       "\"\<gas_pulse_times.txt\>\""}], "]"}], ",", "\"\<\\n\>\""}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.909672104701314*^9, 3.9096721516669874`*^9}, {
  3.909672349749567*^9, 3.9096723665026913`*^9}, {3.9096733782092967`*^9, 
  3.9096733788498087`*^9}},
 CellLabel->"In[6]:="],

Cell[BoxData[
 RowBox[{"voltageTimestamps", "//", "Column"}]], "Input",
 CellChangeTimes->{{3.9097491531202726`*^9, 3.9097491658427954`*^9}},
 CellLabel->"In[19]:="],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"startDate", "=", 
  RowBox[{"DateObject", "[", 
   RowBox[{"voltageTimestamps", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.909748974160303*^9, 3.909748980240158*^9}},
 CellLabel->"In[41]:="],

Cell[BoxData[
 TemplateBox[{
   RowBox[{"\"Wed 22 Nov 2023 17:11:33\"", 
     StyleBox[
      RowBox[{"\"GMT+\"", "\[InvisibleSpace]", 
        StyleBox["1", NumberMarks -> False, StripOnInput -> False]}], 
      FontColor -> GrayLevel[0.5]]}], 
   RowBox[{"DateObject", "[", 
     RowBox[{
       RowBox[{"{", 
         RowBox[{
          "2023", ",", "11", ",", "22", ",", "17", ",", "11", ",", 
           "33.878875`"}], "}"}], ",", "\"Instant\"", ",", "\"Gregorian\"", 
       ",", "1.`"}], "]"}]},
  "DateObject",
  Editable->False]], "Output",
 CellChangeTimes->{3.909748980605171*^9, 3.9097496281612296`*^9},
 CellLabel->"Out[41]="]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"startDate", "=", 
  RowBox[{"DateObject", "[", "\"\<2023.11.23. 00:00\>\"", "]"}]}]], "Input",
 CellChangeTimes->{{3.9096723542110243`*^9, 3.9096723691074667`*^9}, 
   3.909673383106286*^9, {3.9097327821554193`*^9, 3.9097327975771055`*^9}},
 CellLabel->"In[40]:="],

Cell[BoxData[
 TemplateBox[{
   RowBox[{
     StyleBox["\"Minute: \"", "DateObjectLabel"], "\"Thu 23 Nov 2023 00:00\"", 
     StyleBox[
      RowBox[{"\"GMT+\"", "\[InvisibleSpace]", 
        StyleBox["1", NumberMarks -> False, StripOnInput -> False]}], 
      FontColor -> GrayLevel[0.5]]}], 
   RowBox[{"DateObject", "[", 
     RowBox[{
       RowBox[{"{", 
         RowBox[{"2023", ",", "11", ",", "23", ",", "0", ",", "0"}], "}"}], 
       ",", "\"Minute\"", ",", "\"Gregorian\"", ",", "1.`"}], "]"}]},
  "DateObject",
  Editable->False]], "Output",
 CellChangeTimes->{3.9096722536504226`*^9, 3.9096723698341923`*^9, 
  3.909673383661172*^9, 3.909674364196951*^9, 3.909724117763827*^9, 
  3.909726511726429*^9, 3.90973275505579*^9, 3.909732798027528*^9, 
  3.9097496265794144`*^9},
 CellLabel->"Out[40]="]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"timeGranularity", "=", "\"\<Minute\>\""}], ";"}]], "Input",
 CellChangeTimes->{{3.909672271748087*^9, 3.9096722808034697`*^9}, {
  3.9096726158587284`*^9, 3.909672618418378*^9}, {3.909672744370235*^9, 
  3.9096727457141995`*^9}, {3.909672867154132*^9, 3.9096728677310004`*^9}, {
  3.909749699743672*^9, 3.909749720415506*^9}},
 CellLabel->"In[57]:="],

Cell[BoxData[
 RowBox[{
  RowBox[{"voltageTimes", "=", 
   RowBox[{"Map", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Round", "[", 
       RowBox[{"DateDifferenceInUnits", "[", 
        RowBox[{"startDate", ",", 
         RowBox[{"DateObject", "[", "#", "]"}], ",", "timeGranularity"}], 
        "]"}], "]"}], "\[IndentingNewLine]", "&"}], ",", 
     "voltageTimestamps"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9096723720819683`*^9, 3.9096723872669945`*^9}, {
  3.909672897716729*^9, 3.909672900023387*^9}, {3.909673385410671*^9, 
  3.909673390769606*^9}, {3.909732804938486*^9, 3.909732809778689*^9}},
 CellLabel->"In[58]:="],

Cell[BoxData[
 RowBox[{
  RowBox[{"gasTimes", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Round", "[", 
       RowBox[{"DateDifferenceInUnits", "[", 
        RowBox[{"startDate", ",", 
         RowBox[{"DateObject", "[", 
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "timeGranularity"}], 
        "]"}], "]"}], "&"}], ",", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{"voltageTimestamps", ",", "1"}], "]"}], ",", 
          RowBox[{"Differences", "[", "voltageTimes", "]"}]}], "}"}], "]"}], 
       ",", 
       RowBox[{
        RowBox[{"1", "<", 
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "&"}]}], "]"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.909749601615201*^9, 3.909749616000078*^9}, {
  3.9097497274076414`*^9, 3.909749727839636*^9}},
 CellLabel->"In[61]:="],

Cell[BoxData[
 RowBox[{"gasTimes", "//", "N"}]], "Input",
 CellChangeTimes->{{3.909749690128826*^9, 3.9097497066868954`*^9}},
 CellLabel->"In[62]:="],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
   "6.`", ",", "9.`", ",", "12.`", ",", "14.`", ",", "18.`", ",", "24.`", ",",
     "30.`", ",", "33.`", ",", "36.`", ",", "39.`", ",", "42.`", ",", "44.`", 
    ",", "47.`", ",", "51.`", ",", "54.`", ",", "59.`", ",", "62.`", ",", 
    "67.`", ",", "69.`", ",", "71.`", ",", "78.`", ",", "86.`", ",", "91.`", 
    ",", "97.`", ",", "99.`", ",", "101.`", ",", "116.`", ",", "122.`", ",", 
    "127.`", ",", "129.`", ",", "133.`", ",", "136.`", ",", "156.`", ",", 
    "160.`", ",", "165.`", ",", "169.`", ",", "171.`", ",", "173.`", ",", 
    "175.`", ",", "177.`", ",", "183.`", ",", "186.`", ",", "189.`", ",", 
    "192.`", ",", "195.`", ",", "197.`", ",", "199.`", ",", "201.`", ",", 
    "203.`", ",", "205.`", ",", "211.`", ",", "217.`", ",", "220.`", ",", 
    "224.`", ",", "226.`", ",", "230.`", ",", "232.`", ",", "235.`", ",", 
    "238.`", ",", "242.`", ",", "245.`", ",", "249.`", ",", "251.`", ",", 
    "254.`", ",", "256.`", ",", "258.`", ",", "261.`", ",", "266.`", ",", 
    "270.`", ",", "273.`", ",", "280.`", ",", "283.`", ",", "289.`", ",", 
    "302.`", ",", "307.`", ",", "309.`", ",", "314.`", ",", "327.`", ",", 
    "330.`", ",", "334.`", ",", "342.`", ",", "346.`", ",", "349.`", ",", 
    "352.`", ",", "356.`", ",", "366.`", ",", "375.`", ",", "378.`", ",", 
    "382.`", ",", "385.`", ",", "389.`", ",", "392.`", ",", "396.`", ",", 
    "399.`", ",", "402.`", ",", "405.`", ",", "409.`", ",", "412.`", ",", 
    "416.`", ",", "427.`", ",", "431.`", ",", "435.`", ",", "441.`", ",", 
    "444.`", ",", "447.`", ",", "450.`", ",", "454.`", ",", "457.`", ",", 
    "461.`", ",", "464.`", ",", "467.`", ",", "471.`", ",", "474.`", ",", 
    "478.`", ",", "481.`", ",", "485.`", ",", "515.`", ",", "543.`", ",", 
    "547.`", ",", "549.`", ",", "552.`", ",", "555.`", ",", "558.`", ",", 
    "561.`", ",", "564.`", ",", "568.`", ",", "571.`", ",", "574.`", ",", 
    "578.`", ",", "581.`", ",", "588.`", ",", "591.`", ",", "594.`", ",", 
    "597.`", ",", "603.`", ",", "610.`", ",", "612.`", ",", "617.`", ",", 
    "619.`", ",", "622.`", ",", "628.`", ",", "631.`", ",", "638.`", ",", 
    "643.`", ",", "646.`", ",", "651.`", ",", "655.`", ",", "661.`", ",", 
    "664.`", ",", "667.`", ",", "675.`", ",", "678.`", ",", "682.`", ",", 
    "686.`", ",", "688.`", ",", "694.`", ",", "697.`", ",", "703.`", ",", 
    "706.`", ",", "713.`", ",", "719.`", ",", "721.`", ",", "728.`", ",", 
    "739.`", ",", "743.`", ",", "746.`", ",", "752.`", ",", "756.`", ",", 
    "762.`", ",", "765.`", ",", "768.`", ",", "791.`", ",", "798.`", ",", 
    "800.`", ",", "803.`", ",", "807.`", ",", "810.`", ",", "813.`", ",", 
    "816.`", ",", "828.`", ",", "832.`", ",", "840.`", ",", "855.`", ",", 
    "857.`", ",", "859.`", ",", "863.`", ",", "865.`", ",", "867.`", ",", 
    "869.`", ",", "871.`", ",", "873.`", ",", "875.`", ",", "878.`", ",", 
    "881.`", ",", "884.`", ",", "886.`", ",", "888.`", ",", "890.`", ",", 
    "892.`", ",", "894.`", ",", "896.`", ",", "898.`", ",", "900.`", ",", 
    "902.`", ",", "904.`", ",", "908.`", ",", "910.`", ",", "913.`", ",", 
    "915.`", ",", "917.`", ",", "919.`", ",", "921.`", ",", "923.`", ",", 
    "925.`", ",", "927.`", ",", "929.`", ",", "931.`", ",", "936.`", ",", 
    "938.`", ",", "940.`", ",", "942.`", ",", "944.`", ",", "947.`", ",", 
    "950.`", ",", "955.`", ",", "959.`", ",", "961.`", ",", "964.`", ",", 
    "966.`", ",", "969.`", ",", "974.`", ",", "986.`", ",", "1000.`", ",", 
    "1008.`", ",", "1012.`", ",", "1019.`", ",", "1023.`", ",", "1026.`", ",",
     "1029.`", ",", "1031.`", ",", "1034.`", ",", "1036.`", ",", "1038.`", 
    ",", "1040.`", ",", "1042.`", ",", "1044.`", ",", "1046.`", ",", "1048.`",
     ",", "1053.`", ",", "1058.`", ",", "1065.`", ",", "1077.`", ",", 
    "1080.`", ",", "1082.`", ",", "1094.`", ",", "1104.`", ",", "1106.`", ",",
     "1108.`", ",", "1111.`", ",", "1114.`", ",", "1116.`", ",", "1121.`", 
    ",", "1126.`", ",", "1129.`", ",", "1132.`", ",", "1135.`", ",", "1140.`",
     ",", "1155.`", ",", "1158.`", ",", "1160.`", ",", "1163.`", ",", 
    "1166.`", ",", "1169.`", ",", "1177.`", ",", "1186.`", ",", "1189.`", ",",
     "1193.`", ",", "1195.`", ",", "1210.`", ",", "1213.`", ",", "1217.`", 
    ",", "1220.`", ",", "1223.`", ",", "1229.`", ",", "1231.`", ",", "1233.`",
     ",", "1236.`"}], "}"}], " "}]], "Input",
 CellChangeTimes->{{3.909749734079075*^9, 3.9097497340822816`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"MovingAverage", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"BinCounts", "[", 
       RowBox[{"gasTimes", ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"Max", "[", "gasTimes", "]"}], ",", "10"}], "}"}]}], "]"}], 
      "0.1"}], ",", "10"}], "]"}], ",", 
   RowBox[{"Joined", "\[Rule]", "True"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.909675258536501*^9, 3.909675263088312*^9}, {
   3.90968013029885*^9, 3.9096801744106236`*^9}, {3.9097241356376123`*^9, 
   3.909724157905903*^9}, 3.9097265457143717`*^9, {3.9097327589217668`*^9, 
   3.909732763305879*^9}, {3.9097496356637363`*^9, 3.909749667463953*^9}, {
   3.909749739760186*^9, 3.9097497686395817`*^9}},
 CellLabel->"In[66]:="],

Cell[BoxData[
 GraphicsBox[{{}, {{}, {}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.009166666666666668], 
     AbsoluteThickness[1.6], LineBox[CompressedData["
1:eJxdlTtMVFEQho9WBi0sKCwMQWPMBo1RwScu+8v7zd7HvqlM0FKkRIvTWGtr
LNXWGrW5AYyPgAFfGDu01MKG3j06hP3/k2xuvp0zM3dm/nPusRu347n9zrmF
5i88/68/hX3/nhsF+wMvO+7/ipY+GB/AqdkHyzu5NePDYm9HF9mPIF0KG94a
H8XqTq6547Vxp/BxJLT/BH4stj8f2X5vfFLi5yR/Fxy9/2nhMxjdDgE3jc+i
pzusT8bn0BnCdXwxPo97If3iZ+Nu2d8jfAHP5vNtW092813EU+JL8j6XsRDM
8+vGV6Teq8K90p9rONj0zre9Mc4L9wkXJB6YPaS/15m9sOsXe7/UM8D1+gHp
x6DYByX+EOLWev0QDlE9w6wfP2zzWDH7CLMXdqNiF3ZjYh+Tfo7zPPy4nI8J
1qefEH1Mgs6bnxQ9T+EF+U/hDvV3WuzT0v8ZyT8j/S0yo4ifpAfhrCj6iZgR
ST8iOz+r5i/sYqy0zg8x99fHPN9M2CUcD4noIWG9ZInMJ+V5IMXD5RDgo/mn
fL6zFHfpPijZ+26Zf8nq/2b+JfSFceS/m7+wKzOjbHrf9S/j1s2wvpp/We6b
Cn5HwcHuM1RETxXWQ1YRfVV5P6qilyrPN6uyHlxN9FPjfL6GV63xshrnc3U4
yl8X/zp/PzJh15D8DZ6vF3vWkPMxi8ePwnpn/sJ+j/8CD4bvvQ==
      "]]}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0., 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageMargins->0.,
  ImageSize->Automatic,
  ImageSizeRaw->Automatic,
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotRange->{{0., 114.}, {0, 0.41000000000000003`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.909749645215886*^9, 3.909749667561363*^9}, {
  3.9097497307220535`*^9, 3.9097497699660983`*^9}},
 CellLabel->"Out[66]="]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["heat", "Section",
 CellChangeTimes->{{3.9097501410708375`*^9, 3.9097501511823034`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"groundTruth", "=", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"3786", ",", "5334"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"1585", ",", "8044"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"222", ",", "6678"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"44", ",", "1044"}], "}"}]}], "\[IndentingNewLine]", "}"}]}], 
   ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "f\[UDoubleAcute]t\[EAcute]si", ",", " ", "h\[UDoubleAcute]t\[EAcute]si"}],
    "*)"}]}]], "Input",
 CellChangeTimes->{{3.9097541241569605`*^9, 3.9097541321744165`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FormatHeatmeterEntry", "[", "entry_", "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "list", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"list", "=", 
      RowBox[{
       RowBox[{"StringSplit", "[", 
        RowBox[{"entry", ",", "\"\<\>\""}], "]"}], "/.", 
       RowBox[{"{", 
        RowBox[{"\"\<-\>\"", "->", 
         RowBox[{"-", "1"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"list", "[", 
           RowBox[{"[", "pos", "]"}], "]"}], "==", 
          RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", "Nothing", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"1", "<", "pos"}], "&&", 
            RowBox[{
             RowBox[{"list", "[", 
              RowBox[{"[", 
               RowBox[{"pos", "-", "1"}], "]"}], "]"}], "==", 
             RowBox[{"-", "1"}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"-", 
            RowBox[{"ToExpression", "[", 
             RowBox[{"list", "[", 
              RowBox[{"[", "pos", "]"}], "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ToExpression", "[", 
            RowBox[{"list", "[", 
             RowBox[{"[", "pos", "]"}], "]"}], "]"}]}], "\[IndentingNewLine]",
           "]"}]}], "]"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"pos", ",", "1", ",", 
         RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.9097515905739865`*^9, 3.9097515933570824`*^9}, {
  3.9097516850377846`*^9, 3.9097517306384935`*^9}},
 CellLabel->"In[69]:="],

Cell[BoxData[
 RowBox[{
  RowBox[{"startDate", "=", 
   RowBox[{"DateObject", "[", "\"\<2023.11.21. 21:45\>\"", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.90975043939682*^9, 3.9097504688977437`*^9}, {
  3.9097521867487526`*^9, 3.9097522066207633`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"timeGranularity", "=", "\"\<Minute\>\""}], ";"}]], "Input",
 CellChangeTimes->{{3.909672271748087*^9, 3.9096722808034697`*^9}, {
  3.9096726158587284`*^9, 3.909672618418378*^9}, {3.909672744370235*^9, 
  3.9096727457141995`*^9}, {3.909672867154132*^9, 3.9096728677310004`*^9}, {
  3.909749699743672*^9, 3.909749720415506*^9}, {3.909752053229503*^9, 
  3.9097520798854284`*^9}},
 CellLabel->"In[80]:="],

Cell[BoxData[
 RowBox[{
  RowBox[{"readout", "=", 
   RowBox[{"Map", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Join", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Round", "[", 
          RowBox[{
           RowBox[{"DateDifferenceInUnits", "[", 
            RowBox[{"startDate", ",", 
             RowBox[{"DateObject", "[", 
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
             "timeGranularity"}], "]"}], ",", "0.25"}], "]"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Map", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"FormatHeatmeterEntry", "[", "#", "]"}], 
           "\[IndentingNewLine]", "&"}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", 
            RowBox[{"2", ";;", "5"}], "]"}], "]"}]}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "&"}], ",", 
     RowBox[{"Map", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"StringSplit", "[", 
         RowBox[{"#", ",", "\"\<,\>\""}], "]"}], "\[IndentingNewLine]", "&"}],
        ",", 
       RowBox[{"StringSplit", "[", 
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
            "\"\<heatmeter_readouts.csv\>\""}], ",", "\"\<Text\>\""}], "]"}], 
         ",", "\"\<\\n\>\""}], "]"}]}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9097501927533493`*^9, 3.9097502120950627`*^9}, {
  3.909750252750537*^9, 3.9097502807669373`*^9}, {3.909750315615937*^9, 
  3.9097503422714825`*^9}, {3.9097503931499615`*^9, 3.9097503935723724`*^9}, {
  3.909750707438752*^9, 3.909750797247377*^9}, {3.90975097627057*^9, 
  3.90975097719893*^9}, {3.909751599823715*^9, 3.909751601117702*^9}, {
  3.909751934814169*^9, 3.9097519370213313`*^9}, {3.9097520831025524`*^9, 
  3.909752084237811*^9}, {3.909754221018126*^9, 3.9097542228912354`*^9}},
 CellLabel->"In[105]:="],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Map", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"ToExpression", "[", 
           RowBox[{"StringRiffle", "[", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", "\"\<\>\""}], "]"}], 
           "]"}]}], "}"}], "&"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Select", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", "readout", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"cycle", "+", "1"}]}], "}"}], "]"}], "]"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"-", "1"}]}], "]"}], "==", "False"}], "&"}]}], 
        "\[IndentingNewLine]", "]"}]}], "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "-", 
        RowBox[{
         RowBox[{"groundTruth", "[", 
          RowBox[{"[", "cycle", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "<", "1500"}], "&"}]}], "]"}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{"cycle", ",", "1", ",", "4"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.90975223783969*^9, 3.909752387442824*^9}, {
  3.9097524439014797`*^9, 3.9097524475649433`*^9}, {3.9097528001885624`*^9, 
  3.90975282044613*^9}, {3.9097541660284624`*^9, 3.9097541935949025`*^9}, {
  3.9097542461717763`*^9, 3.9097542663629994`*^9}, {3.9097543004586077`*^9, 
  3.9097544755643854`*^9}, {3.9097545361240377`*^9, 3.9097546187305794`*^9}, {
  3.9097546514838743`*^9, 3.9097547248258266`*^9}},
 CellLabel->"In[146]:="],

Cell[CellGroupData[{

Cell[BoxData[
 DynamicBox[ToBoxes[
   StringJoin["Making second backup, ", 
    FileNameTake[NotebookBackup`Private`bakfile2$276292], "..."], 
   StandardForm],
  Evaluator->"Local",
  ImageSizeCache->{318.498046875, {3., 9.}}]], "PrintTemporary",
 CellChangeTimes->{3.909754725349677*^9},
 CellLabel->"During evaluation of In[146]:="],

Cell[BoxData[
 DynamicBox[ToBoxes[
   StringJoin["Backing up ", 
    FileNameTake[NotebookBackup`Private`nbfile$276292], " to ", 
    FileNameTake[NotebookBackup`Private`bakfile$276292], "..."], StandardForm],
  Evaluator->"Local",
  ImageSizeCache->{404.267578125, {3., 9.}}]], "PrintTemporary",
 CellChangeTimes->{3.909754725375692*^9},
 CellLabel->"During evaluation of In[146]:="]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1525.2, 820.8},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
WindowStatusArea->"analyzer-dashboard.nb last backed up to \
analyzer-dashboard.nb~ on Thu 23 Nov 2023 at 7:48:37 PM",
FrontEndVersion->"12.3 for Microsoft Windows (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 96, 1, 70, "Section",ExpressionUUID->"8e4bbc37-06c9-4b6b-a1f8-357c13813455"],
Cell[679, 25, 419, 10, 70, "Input",ExpressionUUID->"2c9f8809-01d7-49ad-b752-f20085caaa97",
 InitializationCell->True],
Cell[1101, 37, 1303, 34, 70, "Input",ExpressionUUID->"9540eda7-9788-487f-9c7c-908bf6b73e48",
 InitializationCell->True],
Cell[2407, 73, 1185, 30, 70, "Input",ExpressionUUID->"a8bf24f5-5cae-44ae-8fdc-c8c5bb19a4c4",
 InitializationCell->True],
Cell[3595, 105, 3235, 83, 70, "Input",ExpressionUUID->"50604c40-5fd8-4743-b160-67ecf7f7f67d",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[6867, 193, 90, 1, 70, "Section",ExpressionUUID->"6a96319f-8e94-4ae3-9f81-63da0c2bfee5"],
Cell[6960, 196, 497, 13, 70, "Input",ExpressionUUID->"869e0545-c4ca-40a2-aa4d-0860907aa3a6"],
Cell[7460, 211, 165, 3, 70, "Input",ExpressionUUID->"3952e5f0-93a7-4312-9286-fe2f30b8668f"],
Cell[CellGroupData[{
Cell[7650, 218, 254, 6, 70, "Input",ExpressionUUID->"9f8ba6cb-8e7e-4cae-8971-6384e1aead81"],
Cell[7907, 226, 640, 17, 70, "Output",ExpressionUUID->"7ac8c446-b490-407e-a56a-0929b5e78bf6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8584, 248, 288, 5, 70, "Input",ExpressionUUID->"1e04b4d2-7782-4157-a5bd-68316f572760"],
Cell[8875, 255, 809, 19, 70, "Output",ExpressionUUID->"e2c4d378-2205-49c0-8f11-d2fe20efaceb"]
}, Open  ]],
Cell[9699, 277, 385, 7, 70, "Input",ExpressionUUID->"6bb1be37-f10b-4bcf-a2c6-320ddc0c4a07"],
Cell[10087, 286, 664, 15, 70, "Input",ExpressionUUID->"a0efd0d9-5def-4f32-87cc-fd6119a08354"],
Cell[10754, 303, 999, 29, 70, "Input",ExpressionUUID->"1aabcbfa-d976-4463-b5b3-b921c9c88b8a"],
Cell[11756, 334, 149, 3, 70, "Input",ExpressionUUID->"071eb199-d38f-41aa-97ad-12164cb758d0"],
Cell[11908, 339, 4474, 62, 70, "Input",ExpressionUUID->"72e0bbc0-a97c-46d9-af72-89af4555c7de"],
Cell[CellGroupData[{
Cell[16407, 405, 778, 18, 70, "Input",ExpressionUUID->"a169c3e5-5512-4cf1-9c58-238c4a5e8ea9"],
Cell[17188, 425, 2100, 52, 70, "Output",ExpressionUUID->"b0338377-e67c-488a-b9cb-53d763f89305"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[19337, 483, 93, 1, 70, "Section",ExpressionUUID->"373fc1a5-a6fe-4af3-8c33-92c015578329"],
Cell[19433, 486, 713, 19, 70, "Input",ExpressionUUID->"680bc7b0-dc48-48fd-9956-12d978e3b12e"],
Cell[20149, 507, 1889, 47, 70, "Input",ExpressionUUID->"94aab88f-f2dc-41c5-a9ee-3a14d1c945f4"],
Cell[22041, 556, 260, 6, 70, "Input",ExpressionUUID->"9bd1b790-2f85-49f2-a596-6f29d27146f7"],
Cell[22304, 564, 436, 8, 70, "Input",ExpressionUUID->"5428986f-1f92-4afc-990a-814d66eb5fb7"],
Cell[22743, 574, 2071, 48, 70, "Input",ExpressionUUID->"3be338a5-179a-48c5-8a64-7183eacac99d"],
Cell[CellGroupData[{
Cell[24839, 626, 2132, 54, 70, "Input",ExpressionUUID->"04a4ecc5-721f-4614-bdec-702dff0269ff"],
Cell[CellGroupData[{
Cell[26996, 684, 335, 8, 70, "PrintTemporary",ExpressionUUID->"2b296f0c-8f97-4230-9e22-dfeac675551d"],
Cell[27334, 694, 384, 8, 70, "PrintTemporary",ExpressionUUID->"09c5eef4-cdec-43b9-bec9-e1a546b72d5b"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
